{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _createForOfIteratorHelper from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _toConsumableArray from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _get from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _callSuper from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _classCallCheck from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _typeof from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.reflect.to-string-tag.js\";\nimport \"core-js/modules/web.timers.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if ((typeof Reflect === \"undefined\" ? \"undefined\" : _typeof(Reflect)) === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar WordHighlighter_1, WordHighlighterContribution_1;\nimport * as nls from '../../../../nls.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, first, timeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport { shouldSynchronizeModel } from '../../../common/model.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getHighlightDecorationOptions } from './highlightDecorations.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { score } from '../../../common/languageSelector.js';\n// import { TextualMultiDocumentHighlightFeature } from 'vs/editor/contrib/wordHighlighter/browser/textualHighlightProvider';\n// import { registerEditorFeature } from 'vs/editor/common/editorFeatures';\nvar ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\nexport function getOccurrencesAtPosition(registry, model, position, token) {\n  var orderedByScore = registry.ordered(model);\n  // in order of score ask the occurrences provider\n  // until someone response with a good result\n  // (good = none empty array)\n  return first(orderedByScore.map(function (provider) {\n    return function () {\n      return Promise.resolve(provider.provideDocumentHighlights(model, position, token)).then(undefined, onUnexpectedExternalError);\n    };\n  }), arrays.isNonEmptyArray).then(function (result) {\n    if (result) {\n      var map = new ResourceMap();\n      map.set(model.uri, result);\n      return map;\n    }\n    return new ResourceMap();\n  });\n}\nexport function getOccurrencesAcrossMultipleModels(registry, model, position, wordSeparators, token, otherModels) {\n  var orderedByScore = registry.ordered(model);\n  // in order of score ask the occurrences provider\n  // until someone response with a good result\n  // (good = none empty array)\n  return first(orderedByScore.map(function (provider) {\n    return function () {\n      var filteredModels = otherModels.filter(function (otherModel) {\n        return shouldSynchronizeModel(otherModel);\n      }).filter(function (otherModel) {\n        return score(provider.selector, otherModel.uri, otherModel.getLanguageId(), true, undefined, undefined) > 0;\n      });\n      return Promise.resolve(provider.provideMultiDocumentHighlights(model, position, filteredModels, token)).then(undefined, onUnexpectedExternalError);\n    };\n  }), function (t) {\n    return t instanceof ResourceMap && t.size > 0;\n  });\n}\nvar OccurenceAtPositionRequest = /*#__PURE__*/function () {\n  function OccurenceAtPositionRequest(_model, _selection, _wordSeparators) {\n    _classCallCheck(this, OccurenceAtPositionRequest);\n    this._model = _model;\n    this._selection = _selection;\n    this._wordSeparators = _wordSeparators;\n    this._wordRange = this._getCurrentWordRange(_model, _selection);\n    this._result = null;\n  }\n  return _createClass(OccurenceAtPositionRequest, [{\n    key: \"result\",\n    get: function get() {\n      var _this = this;\n      if (!this._result) {\n        this._result = createCancelablePromise(function (token) {\n          return _this._compute(_this._model, _this._selection, _this._wordSeparators, token);\n        });\n      }\n      return this._result;\n    }\n  }, {\n    key: \"_getCurrentWordRange\",\n    value: function _getCurrentWordRange(model, selection) {\n      var word = model.getWordAtPosition(selection.getPosition());\n      if (word) {\n        return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n      }\n      return null;\n    }\n  }, {\n    key: \"isValid\",\n    value: function isValid(model, selection, decorations) {\n      var lineNumber = selection.startLineNumber;\n      var startColumn = selection.startColumn;\n      var endColumn = selection.endColumn;\n      var currentWordRange = this._getCurrentWordRange(model, selection);\n      var requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\n      // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\n      // (Same symbol)\n      for (var i = 0, len = decorations.length; !requestIsValid && i < len; i++) {\n        var range = decorations.getRange(i);\n        if (range && range.startLineNumber === lineNumber) {\n          if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\n            requestIsValid = true;\n          }\n        }\n      }\n      return requestIsValid;\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      this.result.cancel();\n    }\n  }]);\n}();\nvar SemanticOccurenceAtPositionRequest = /*#__PURE__*/function (_OccurenceAtPositionR) {\n  function SemanticOccurenceAtPositionRequest(model, selection, wordSeparators, providers) {\n    var _this2;\n    _classCallCheck(this, SemanticOccurenceAtPositionRequest);\n    _this2 = _callSuper(this, SemanticOccurenceAtPositionRequest, [model, selection, wordSeparators]);\n    _this2._providers = providers;\n    return _this2;\n  }\n  _inherits(SemanticOccurenceAtPositionRequest, _OccurenceAtPositionR);\n  return _createClass(SemanticOccurenceAtPositionRequest, [{\n    key: \"_compute\",\n    value: function _compute(model, selection, wordSeparators, token) {\n      return getOccurrencesAtPosition(this._providers, model, selection.getPosition(), token).then(function (value) {\n        if (!value) {\n          return new ResourceMap();\n        }\n        return value;\n      });\n    }\n  }]);\n}(OccurenceAtPositionRequest);\nvar MultiModelOccurenceRequest = /*#__PURE__*/function (_OccurenceAtPositionR2) {\n  function MultiModelOccurenceRequest(model, selection, wordSeparators, providers, otherModels) {\n    var _this3;\n    _classCallCheck(this, MultiModelOccurenceRequest);\n    _this3 = _callSuper(this, MultiModelOccurenceRequest, [model, selection, wordSeparators]);\n    _this3._providers = providers;\n    _this3._otherModels = otherModels;\n    return _this3;\n  }\n  _inherits(MultiModelOccurenceRequest, _OccurenceAtPositionR2);\n  return _createClass(MultiModelOccurenceRequest, [{\n    key: \"_compute\",\n    value: function _compute(model, selection, wordSeparators, token) {\n      return getOccurrencesAcrossMultipleModels(this._providers, model, selection.getPosition(), wordSeparators, token, this._otherModels).then(function (value) {\n        if (!value) {\n          return new ResourceMap();\n        }\n        return value;\n      });\n    }\n  }]);\n}(OccurenceAtPositionRequest);\nvar TextualOccurenceRequest = /*#__PURE__*/function (_OccurenceAtPositionR3) {\n  function TextualOccurenceRequest(model, selection, word, wordSeparators, otherModels) {\n    var _this4;\n    _classCallCheck(this, TextualOccurenceRequest);\n    _this4 = _callSuper(this, TextualOccurenceRequest, [model, selection, wordSeparators]);\n    _this4._otherModels = otherModels;\n    _this4._selectionIsEmpty = selection.isEmpty();\n    _this4._word = word;\n    return _this4;\n  }\n  _inherits(TextualOccurenceRequest, _OccurenceAtPositionR3);\n  return _createClass(TextualOccurenceRequest, [{\n    key: \"_compute\",\n    value: function _compute(model, selection, wordSeparators, token) {\n      var _this5 = this;\n      return timeout(250, token).then(function () {\n        var result = new ResourceMap();\n        var wordResult;\n        if (_this5._word) {\n          wordResult = _this5._word;\n        } else {\n          wordResult = model.getWordAtPosition(selection.getPosition());\n        }\n        if (!wordResult) {\n          return new ResourceMap();\n        }\n        var allModels = [model].concat(_toConsumableArray(_this5._otherModels));\n        var _iterator = _createForOfIteratorHelper(allModels),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var otherModel = _step.value;\n            if (otherModel.isDisposed()) {\n              continue;\n            }\n            var matches = otherModel.findMatches(wordResult.word, true, false, true, wordSeparators, false);\n            var highlights = matches.map(function (m) {\n              return {\n                range: m.range,\n                kind: DocumentHighlightKind.Text\n              };\n            });\n            if (highlights) {\n              result.set(otherModel.uri, highlights);\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n        return result;\n      });\n    }\n  }, {\n    key: \"isValid\",\n    value: function isValid(model, selection, decorations) {\n      var currentSelectionIsEmpty = selection.isEmpty();\n      if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\n        return false;\n      }\n      return _get(_getPrototypeOf(TextualOccurenceRequest.prototype), \"isValid\", this).call(this, model, selection, decorations);\n    }\n  }]);\n}(OccurenceAtPositionRequest);\nfunction computeOccurencesAtPosition(registry, model, selection, word, wordSeparators) {\n  if (registry.has(model)) {\n    return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators, registry);\n  }\n  return new TextualOccurenceRequest(model, selection, word, wordSeparators, []);\n}\nfunction computeOccurencesMultiModel(registry, model, selection, word, wordSeparators, otherModels) {\n  if (registry.has(model)) {\n    return new MultiModelOccurenceRequest(model, selection, wordSeparators, registry, otherModels);\n  }\n  return new TextualOccurenceRequest(model, selection, word, wordSeparators, otherModels);\n}\nregisterModelAndPositionCommand('_executeDocumentHighlights', /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(accessor, model, position) {\n    var languageFeaturesService, map;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          languageFeaturesService = accessor.get(ILanguageFeaturesService);\n          _context.next = 3;\n          return getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, position, CancellationToken.None);\n        case 3:\n          map = _context.sent;\n          return _context.abrupt(\"return\", map === null || map === void 0 ? void 0 : map.get(model.uri));\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nvar WordHighlighter = WordHighlighter_1 = /*#__PURE__*/function () {\n  function WordHighlighter(editor, providers, multiProviders, contextKeyService, codeEditorService) {\n    var _this6 = this;\n    _classCallCheck(this, WordHighlighter);\n    this.toUnhook = new DisposableStore();\n    this.workerRequestTokenId = 0;\n    this.workerRequestCompleted = false;\n    this.workerRequestValue = new ResourceMap();\n    this.lastCursorPositionChangeTime = 0;\n    this.renderDecorationsTimer = -1;\n    this.editor = editor;\n    this.providers = providers;\n    this.multiDocumentProviders = multiProviders;\n    this.codeEditorService = codeEditorService;\n    this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\n    this._ignorePositionChangeEvent = false;\n    this.occurrencesHighlight = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n    this.model = this.editor.getModel();\n    this.toUnhook.add(editor.onDidChangeCursorPosition(function (e) {\n      if (_this6._ignorePositionChangeEvent) {\n        // We are changing the position => ignore this event\n        return;\n      }\n      if (_this6.occurrencesHighlight === 'off') {\n        // Early exit if nothing needs to be done!\n        // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n        return;\n      }\n      _this6._onPositionChanged(e);\n    }));\n    this.toUnhook.add(editor.onDidFocusEditorText(function (e) {\n      if (_this6.occurrencesHighlight === 'off') {\n        // Early exit if nothing needs to be done\n        return;\n      }\n      if (!_this6.workerRequest) {\n        _this6._run();\n      }\n    }));\n    this.toUnhook.add(editor.onDidChangeModelContent(function (e) {\n      _this6._stopAll();\n    }));\n    this.toUnhook.add(editor.onDidChangeModel(function (e) {\n      if (!e.newModelUrl && e.oldModelUrl) {\n        _this6._stopSingular();\n      } else {\n        if (WordHighlighter_1.query) {\n          _this6._run();\n        }\n      }\n    }));\n    this.toUnhook.add(editor.onDidChangeConfiguration(function (e) {\n      var newValue = _this6.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n      if (_this6.occurrencesHighlight !== newValue) {\n        _this6.occurrencesHighlight = newValue;\n        _this6._stopAll();\n      }\n    }));\n    this.decorations = this.editor.createDecorationsCollection();\n    this.workerRequestTokenId = 0;\n    this.workerRequest = null;\n    this.workerRequestCompleted = false;\n    this.lastCursorPositionChangeTime = 0;\n    this.renderDecorationsTimer = -1;\n    // if there is a query already, highlight off that query\n    if (WordHighlighter_1.query) {\n      this._run();\n    }\n  }\n  return _createClass(WordHighlighter, [{\n    key: \"hasDecorations\",\n    value: function hasDecorations() {\n      return this.decorations.length > 0;\n    }\n  }, {\n    key: \"restore\",\n    value: function restore() {\n      if (this.occurrencesHighlight === 'off') {\n        return;\n      }\n      this._run();\n    }\n  }, {\n    key: \"_getSortedHighlights\",\n    value: function _getSortedHighlights() {\n      return this.decorations.getRanges().sort(Range.compareRangesUsingStarts);\n    }\n  }, {\n    key: \"moveNext\",\n    value: function moveNext() {\n      var _this7 = this;\n      var highlights = this._getSortedHighlights();\n      var index = highlights.findIndex(function (range) {\n        return range.containsPosition(_this7.editor.getPosition());\n      });\n      var newIndex = (index + 1) % highlights.length;\n      var dest = highlights[newIndex];\n      try {\n        this._ignorePositionChangeEvent = true;\n        this.editor.setPosition(dest.getStartPosition());\n        this.editor.revealRangeInCenterIfOutsideViewport(dest);\n        var word = this._getWord();\n        if (word) {\n          var lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n          alert(\"\".concat(lineContent, \", \").concat(newIndex + 1, \" of \").concat(highlights.length, \" for '\").concat(word.word, \"'\"));\n        }\n      } finally {\n        this._ignorePositionChangeEvent = false;\n      }\n    }\n  }, {\n    key: \"moveBack\",\n    value: function moveBack() {\n      var _this8 = this;\n      var highlights = this._getSortedHighlights();\n      var index = highlights.findIndex(function (range) {\n        return range.containsPosition(_this8.editor.getPosition());\n      });\n      var newIndex = (index - 1 + highlights.length) % highlights.length;\n      var dest = highlights[newIndex];\n      try {\n        this._ignorePositionChangeEvent = true;\n        this.editor.setPosition(dest.getStartPosition());\n        this.editor.revealRangeInCenterIfOutsideViewport(dest);\n        var word = this._getWord();\n        if (word) {\n          var lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n          alert(\"\".concat(lineContent, \", \").concat(newIndex + 1, \" of \").concat(highlights.length, \" for '\").concat(word.word, \"'\"));\n        }\n      } finally {\n        this._ignorePositionChangeEvent = false;\n      }\n    }\n  }, {\n    key: \"_removeSingleDecorations\",\n    value: function _removeSingleDecorations() {\n      // return if no model\n      if (!this.editor.hasModel()) {\n        return;\n      }\n      var currentDecorationIDs = WordHighlighter_1.storedDecorations.get(this.editor.getModel().uri);\n      if (!currentDecorationIDs) {\n        return;\n      }\n      this.editor.removeDecorations(currentDecorationIDs);\n      WordHighlighter_1.storedDecorations[\"delete\"](this.editor.getModel().uri);\n      if (this.decorations.length > 0) {\n        this.decorations.clear();\n        this._hasWordHighlights.set(false);\n      }\n    }\n  }, {\n    key: \"_removeAllDecorations\",\n    value: function _removeAllDecorations() {\n      var currentEditors = this.codeEditorService.listCodeEditors();\n      var deleteURI = [];\n      // iterate over editors and store models in currentModels\n      var _iterator2 = _createForOfIteratorHelper(currentEditors),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var editor = _step2.value;\n          if (!editor.hasModel()) {\n            continue;\n          }\n          var currentDecorationIDs = WordHighlighter_1.storedDecorations.get(editor.getModel().uri);\n          if (!currentDecorationIDs) {\n            continue;\n          }\n          editor.removeDecorations(currentDecorationIDs);\n          deleteURI.push(editor.getModel().uri);\n          var editorHighlighterContrib = WordHighlighterContribution.get(editor);\n          if (!(editorHighlighterContrib === null || editorHighlighterContrib === void 0 ? void 0 : editorHighlighterContrib.wordHighlighter)) {\n            continue;\n          }\n          if (editorHighlighterContrib.wordHighlighter.decorations.length > 0) {\n            editorHighlighterContrib.wordHighlighter.decorations.clear();\n            editorHighlighterContrib.wordHighlighter.workerRequest = null;\n            editorHighlighterContrib.wordHighlighter._hasWordHighlights.set(false);\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      for (var _i = 0, _deleteURI = deleteURI; _i < _deleteURI.length; _i++) {\n        var uri = _deleteURI[_i];\n        WordHighlighter_1.storedDecorations[\"delete\"](uri);\n      }\n    }\n  }, {\n    key: \"_stopSingular\",\n    value: function _stopSingular() {\n      var _a, _b, _c, _d;\n      // Remove any existing decorations + a possible query, and re - run to update decorations\n      this._removeSingleDecorations();\n      if (this.editor.hasTextFocus()) {\n        if (((_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri.scheme) !== Schemas.vscodeNotebookCell && ((_c = (_b = WordHighlighter_1.query) === null || _b === void 0 ? void 0 : _b.modelInfo) === null || _c === void 0 ? void 0 : _c.model.uri.scheme) !== Schemas.vscodeNotebookCell) {\n          // clear query if focused non-nb editor\n          WordHighlighter_1.query = null;\n          this._run(); // TODO: @Yoyokrazy -- investigate why we need a full rerun here. likely addressed a case/patch in the first iteration of this feature\n        } else {\n          // remove modelInfo to account for nb cell being disposed\n          if ((_d = WordHighlighter_1.query) === null || _d === void 0 ? void 0 : _d.modelInfo) {\n            WordHighlighter_1.query.modelInfo = null;\n          }\n        }\n      }\n      // Cancel any renderDecorationsTimer\n      if (this.renderDecorationsTimer !== -1) {\n        clearTimeout(this.renderDecorationsTimer);\n        this.renderDecorationsTimer = -1;\n      }\n      // Cancel any worker request\n      if (this.workerRequest !== null) {\n        this.workerRequest.cancel();\n        this.workerRequest = null;\n      }\n      // Invalidate any worker request callback\n      if (!this.workerRequestCompleted) {\n        this.workerRequestTokenId++;\n        this.workerRequestCompleted = true;\n      }\n    }\n  }, {\n    key: \"_stopAll\",\n    value: function _stopAll() {\n      // Remove any existing decorations\n      // TODO: @Yoyokrazy -- this triggers as notebooks scroll, causing highlights to disappear momentarily.\n      // maybe a nb type check?\n      this._removeAllDecorations();\n      // Cancel any renderDecorationsTimer\n      if (this.renderDecorationsTimer !== -1) {\n        clearTimeout(this.renderDecorationsTimer);\n        this.renderDecorationsTimer = -1;\n      }\n      // Cancel any worker request\n      if (this.workerRequest !== null) {\n        this.workerRequest.cancel();\n        this.workerRequest = null;\n      }\n      // Invalidate any worker request callback\n      if (!this.workerRequestCompleted) {\n        this.workerRequestTokenId++;\n        this.workerRequestCompleted = true;\n      }\n    }\n  }, {\n    key: \"_onPositionChanged\",\n    value: function _onPositionChanged(e) {\n      var _a;\n      // disabled\n      if (this.occurrencesHighlight === 'off') {\n        this._stopAll();\n        return;\n      }\n      // ignore typing & other\n      // need to check if the model is a notebook cell, should not stop if nb\n      if (e.reason !== 3 /* CursorChangeReason.Explicit */ && ((_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri.scheme) !== Schemas.vscodeNotebookCell) {\n        this._stopAll();\n        return;\n      }\n      this._run();\n    }\n  }, {\n    key: \"_getWord\",\n    value: function _getWord() {\n      var editorSelection = this.editor.getSelection();\n      var lineNumber = editorSelection.startLineNumber;\n      var startColumn = editorSelection.startColumn;\n      if (this.model.isDisposed()) {\n        return null;\n      }\n      return this.model.getWordAtPosition({\n        lineNumber: lineNumber,\n        column: startColumn\n      });\n    }\n  }, {\n    key: \"getOtherModelsToHighlight\",\n    value: function getOtherModelsToHighlight(model) {\n      if (!model) {\n        return [];\n      }\n      // notebook case\n      var isNotebookEditor = model.uri.scheme === Schemas.vscodeNotebookCell;\n      if (isNotebookEditor) {\n        var _currentModels = [];\n        var _currentEditors = this.codeEditorService.listCodeEditors();\n        var _iterator3 = _createForOfIteratorHelper(_currentEditors),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var editor = _step3.value;\n            var tempModel = editor.getModel();\n            if (tempModel && tempModel !== model && tempModel.uri.scheme === Schemas.vscodeNotebookCell) {\n              _currentModels.push(tempModel);\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n        return _currentModels;\n      }\n      // inline case\n      // ? current works when highlighting outside of an inline diff, highlighting in.\n      // ? broken when highlighting within a diff editor. highlighting the main editor does not work\n      // ? editor group service could be useful here\n      var currentModels = [];\n      var currentEditors = this.codeEditorService.listCodeEditors();\n      var _iterator4 = _createForOfIteratorHelper(currentEditors),\n        _step4;\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var _editor = _step4.value;\n          if (!isDiffEditor(_editor)) {\n            continue;\n          }\n          var diffModel = _editor.getModel();\n          if (!diffModel) {\n            continue;\n          }\n          if (model === diffModel.modified) {\n            // embedded inline chat diff would pass this, allowing highlights\n            //? currentModels.push(diffModel.original);\n            currentModels.push(diffModel.modified);\n          }\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n      if (currentModels.length) {\n        // no matching editors have been found\n        return currentModels;\n      }\n      // multi-doc OFF\n      if (this.occurrencesHighlight === 'singleFile') {\n        return [];\n      }\n      // multi-doc ON\n      var _iterator5 = _createForOfIteratorHelper(currentEditors),\n        _step5;\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var _editor2 = _step5.value;\n          var _tempModel = _editor2.getModel();\n          var isValidModel = _tempModel && _tempModel !== model;\n          if (isValidModel) {\n            currentModels.push(_tempModel);\n          }\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n      return currentModels;\n    }\n  }, {\n    key: \"_run\",\n    value: function _run() {\n      var _this9 = this;\n      var _a;\n      var workerRequestIsValid;\n      var hasTextFocus = this.editor.hasTextFocus();\n      if (!hasTextFocus) {\n        // new nb cell scrolled in, didChangeModel fires\n        if (!WordHighlighter_1.query) {\n          // no previous query, nothing to highlight off of\n          return;\n        }\n      } else {\n        // has text focus\n        var editorSelection = this.editor.getSelection();\n        // ignore multiline selection\n        if (!editorSelection || editorSelection.startLineNumber !== editorSelection.endLineNumber) {\n          WordHighlighter_1.query = null;\n          this._stopAll();\n          return;\n        }\n        var startColumn = editorSelection.startColumn;\n        var endColumn = editorSelection.endColumn;\n        var word = this._getWord();\n        // The selection must be inside a word or surround one word at most\n        if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\n          // no previous query, nothing to highlight\n          WordHighlighter_1.query = null;\n          this._stopAll();\n          return;\n        }\n        // All the effort below is trying to achieve this:\n        // - when cursor is moved to a word, trigger immediately a findOccurrences request\n        // - 250ms later after the last cursor move event, render the occurrences\n        // - no flickering!\n        workerRequestIsValid = this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this.decorations);\n        WordHighlighter_1.query = {\n          modelInfo: {\n            model: this.model,\n            selection: editorSelection\n          },\n          word: word\n        };\n      }\n      // There are 4 cases:\n      // a) old workerRequest is valid & completed, renderDecorationsTimer fired\n      // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\n      // c) old workerRequest is valid, but not completed\n      // d) old workerRequest is not valid\n      // For a) no action is needed\n      // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\n      this.lastCursorPositionChangeTime = new Date().getTime();\n      if (workerRequestIsValid) {\n        if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\n          // case b)\n          // Delay the firing of renderDecorationsTimer by an extra 250 ms\n          clearTimeout(this.renderDecorationsTimer);\n          this.renderDecorationsTimer = -1;\n          this._beginRenderDecorations();\n        }\n      } else {\n        // case d)\n        // Stop all previous actions and start fresh\n        this._stopAll();\n        var myRequestId = ++this.workerRequestTokenId;\n        this.workerRequestCompleted = false;\n        var otherModelsToHighlight = this.getOtherModelsToHighlight(this.editor.getModel());\n        // when reaching here, there are two possible states.\n        // \t\t1) we have text focus, and a valid query was updated.\n        // \t\t2) we do not have text focus, and a valid query is cached.\n        // the query will ALWAYS have the correct data for the current highlight request, so it can always be passed to the workerRequest safely\n        if (!WordHighlighter_1.query.modelInfo || WordHighlighter_1.query.modelInfo.model.isDisposed()) {\n          return;\n        }\n        this.workerRequest = this.computeWithModel(WordHighlighter_1.query.modelInfo.model, WordHighlighter_1.query.modelInfo.selection, WordHighlighter_1.query.word, otherModelsToHighlight);\n        (_a = this.workerRequest) === null || _a === void 0 ? void 0 : _a.result.then(function (data) {\n          if (myRequestId === _this9.workerRequestTokenId) {\n            _this9.workerRequestCompleted = true;\n            _this9.workerRequestValue = data || [];\n            _this9._beginRenderDecorations();\n          }\n        }, onUnexpectedError);\n      }\n    }\n  }, {\n    key: \"computeWithModel\",\n    value: function computeWithModel(model, selection, word, otherModels) {\n      if (!otherModels.length) {\n        return computeOccurencesAtPosition(this.providers, model, selection, word, this.editor.getOption(131 /* EditorOption.wordSeparators */));\n      } else {\n        return computeOccurencesMultiModel(this.multiDocumentProviders, model, selection, word, this.editor.getOption(131 /* EditorOption.wordSeparators */), otherModels);\n      }\n    }\n  }, {\n    key: \"_beginRenderDecorations\",\n    value: function _beginRenderDecorations() {\n      var _this10 = this;\n      var currentTime = new Date().getTime();\n      var minimumRenderTime = this.lastCursorPositionChangeTime + 250;\n      if (currentTime >= minimumRenderTime) {\n        // Synchronous\n        this.renderDecorationsTimer = -1;\n        this.renderDecorations();\n      } else {\n        // Asynchronous\n        this.renderDecorationsTimer = setTimeout(function () {\n          _this10.renderDecorations();\n        }, minimumRenderTime - currentTime);\n      }\n    }\n  }, {\n    key: \"renderDecorations\",\n    value: function renderDecorations() {\n      var _this11 = this;\n      var _a, _b, _c;\n      this.renderDecorationsTimer = -1;\n      // create new loop, iterate over current editors using this.codeEditorService.listCodeEditors(),\n      // if the URI of that codeEditor is in the map, then add the decorations to the decorations array\n      // then set the decorations for the editor\n      var currentEditors = this.codeEditorService.listCodeEditors();\n      var _iterator6 = _createForOfIteratorHelper(currentEditors),\n        _step6;\n      try {\n        var _loop = function _loop() {\n          var editor = _step6.value;\n          var editorHighlighterContrib = WordHighlighterContribution.get(editor);\n          if (!editorHighlighterContrib) {\n            return 1; // continue\n          }\n          var newDecorations = [];\n          var uri = (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri;\n          if (uri && _this11.workerRequestValue.has(uri)) {\n            var oldDecorationIDs = WordHighlighter_1.storedDecorations.get(uri);\n            var newDocumentHighlights = _this11.workerRequestValue.get(uri);\n            if (newDocumentHighlights) {\n              var _iterator7 = _createForOfIteratorHelper(newDocumentHighlights),\n                _step7;\n              try {\n                for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n                  var highlight = _step7.value;\n                  if (!highlight.range) {\n                    continue;\n                  }\n                  newDecorations.push({\n                    range: highlight.range,\n                    options: getHighlightDecorationOptions(highlight.kind)\n                  });\n                }\n              } catch (err) {\n                _iterator7.e(err);\n              } finally {\n                _iterator7.f();\n              }\n            }\n            var newDecorationIDs = [];\n            editor.changeDecorations(function (changeAccessor) {\n              newDecorationIDs = changeAccessor.deltaDecorations(oldDecorationIDs !== null && oldDecorationIDs !== void 0 ? oldDecorationIDs : [], newDecorations);\n            });\n            WordHighlighter_1.storedDecorations = WordHighlighter_1.storedDecorations.set(uri, newDecorationIDs);\n            if (newDecorations.length > 0) {\n              (_b = editorHighlighterContrib.wordHighlighter) === null || _b === void 0 ? void 0 : _b.decorations.set(newDecorations);\n              (_c = editorHighlighterContrib.wordHighlighter) === null || _c === void 0 ? void 0 : _c._hasWordHighlights.set(true);\n            }\n          }\n        };\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          if (_loop()) continue;\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this._stopSingular();\n      this.toUnhook.dispose();\n    }\n  }]);\n}();\nWordHighlighter.storedDecorations = new ResourceMap();\nWordHighlighter.query = null;\nWordHighlighter = WordHighlighter_1 = __decorate([__param(4, ICodeEditorService)], WordHighlighter);\nvar WordHighlighterContribution = WordHighlighterContribution_1 = /*#__PURE__*/function (_Disposable) {\n  function WordHighlighterContribution(editor, contextKeyService, languageFeaturesService, codeEditorService) {\n    var _this12;\n    _classCallCheck(this, WordHighlighterContribution);\n    _this12 = _callSuper(this, WordHighlighterContribution);\n    _this12._wordHighlighter = null;\n    var createWordHighlighterIfPossible = function createWordHighlighterIfPossible() {\n      if (editor.hasModel() && !editor.getModel().isTooLargeForTokenization()) {\n        _this12._wordHighlighter = new WordHighlighter(editor, languageFeaturesService.documentHighlightProvider, languageFeaturesService.multiDocumentHighlightProvider, contextKeyService, codeEditorService);\n      }\n    };\n    _this12._register(editor.onDidChangeModel(function (e) {\n      if (_this12._wordHighlighter) {\n        _this12._wordHighlighter.dispose();\n        _this12._wordHighlighter = null;\n      }\n      createWordHighlighterIfPossible();\n    }));\n    createWordHighlighterIfPossible();\n    return _this12;\n  }\n  _inherits(WordHighlighterContribution, _Disposable);\n  return _createClass(WordHighlighterContribution, [{\n    key: \"wordHighlighter\",\n    get: function get() {\n      return this._wordHighlighter;\n    }\n  }, {\n    key: \"saveViewState\",\n    value: function saveViewState() {\n      if (this._wordHighlighter && this._wordHighlighter.hasDecorations()) {\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: \"moveNext\",\n    value: function moveNext() {\n      var _a;\n      (_a = this._wordHighlighter) === null || _a === void 0 ? void 0 : _a.moveNext();\n    }\n  }, {\n    key: \"moveBack\",\n    value: function moveBack() {\n      var _a;\n      (_a = this._wordHighlighter) === null || _a === void 0 ? void 0 : _a.moveBack();\n    }\n  }, {\n    key: \"restoreViewState\",\n    value: function restoreViewState(state) {\n      if (this._wordHighlighter && state) {\n        this._wordHighlighter.restore();\n      }\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      if (this._wordHighlighter) {\n        this._wordHighlighter.dispose();\n        this._wordHighlighter = null;\n      }\n      _get(_getPrototypeOf(WordHighlighterContribution.prototype), \"dispose\", this).call(this);\n    }\n  }], [{\n    key: \"get\",\n    value: function get(editor) {\n      return editor.getContribution(WordHighlighterContribution_1.ID);\n    }\n  }]);\n}(Disposable);\nWordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\nWordHighlighterContribution = WordHighlighterContribution_1 = __decorate([__param(1, IContextKeyService), __param(2, ILanguageFeaturesService), __param(3, ICodeEditorService)], WordHighlighterContribution);\nexport { WordHighlighterContribution };\nvar WordHighlightNavigationAction = /*#__PURE__*/function (_EditorAction) {\n  function WordHighlightNavigationAction(next, opts) {\n    var _this13;\n    _classCallCheck(this, WordHighlightNavigationAction);\n    _this13 = _callSuper(this, WordHighlightNavigationAction, [opts]);\n    _this13._isNext = next;\n    return _this13;\n  }\n  _inherits(WordHighlightNavigationAction, _EditorAction);\n  return _createClass(WordHighlightNavigationAction, [{\n    key: \"run\",\n    value: function run(accessor, editor) {\n      var controller = WordHighlighterContribution.get(editor);\n      if (!controller) {\n        return;\n      }\n      if (this._isNext) {\n        controller.moveNext();\n      } else {\n        controller.moveBack();\n      }\n    }\n  }]);\n}(EditorAction);\nvar NextWordHighlightAction = /*#__PURE__*/function (_WordHighlightNavigat) {\n  function NextWordHighlightAction() {\n    _classCallCheck(this, NextWordHighlightAction);\n    return _callSuper(this, NextWordHighlightAction, [true, {\n      id: 'editor.action.wordHighlight.next',\n      label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\n      alias: 'Go to Next Symbol Highlight',\n      precondition: ctxHasWordHighlights,\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 65 /* KeyCode.F7 */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }\n    }]);\n  }\n  _inherits(NextWordHighlightAction, _WordHighlightNavigat);\n  return _createClass(NextWordHighlightAction);\n}(WordHighlightNavigationAction);\nvar PrevWordHighlightAction = /*#__PURE__*/function (_WordHighlightNavigat2) {\n  function PrevWordHighlightAction() {\n    _classCallCheck(this, PrevWordHighlightAction);\n    return _callSuper(this, PrevWordHighlightAction, [false, {\n      id: 'editor.action.wordHighlight.prev',\n      label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\n      alias: 'Go to Previous Symbol Highlight',\n      precondition: ctxHasWordHighlights,\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024 /* KeyMod.Shift */ | 65 /* KeyCode.F7 */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }\n    }]);\n  }\n  _inherits(PrevWordHighlightAction, _WordHighlightNavigat2);\n  return _createClass(PrevWordHighlightAction);\n}(WordHighlightNavigationAction);\nvar TriggerWordHighlightAction = /*#__PURE__*/function (_EditorAction2) {\n  function TriggerWordHighlightAction() {\n    _classCallCheck(this, TriggerWordHighlightAction);\n    return _callSuper(this, TriggerWordHighlightAction, [{\n      id: 'editor.action.wordHighlight.trigger',\n      label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\n      alias: 'Trigger Symbol Highlight',\n      precondition: ctxHasWordHighlights.toNegated(),\n      kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 0,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }\n    }]);\n  }\n  _inherits(TriggerWordHighlightAction, _EditorAction2);\n  return _createClass(TriggerWordHighlightAction, [{\n    key: \"run\",\n    value: function run(accessor, editor, args) {\n      var controller = WordHighlighterContribution.get(editor);\n      if (!controller) {\n        return;\n      }\n      controller.restoreViewState(true);\n    }\n  }]);\n}(EditorAction);\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(NextWordHighlightAction);\nregisterEditorAction(PrevWordHighlightAction);\nregisterEditorAction(TriggerWordHighlightAction);\n// registerEditorFeature(TextualMultiDocumentHighlightFeature);","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","_typeof","decorate","i","defineProperty","__param","paramIndex","decorator","WordHighlighter_1","WordHighlighterContribution_1","nls","arrays","alert","createCancelablePromise","first","timeout","CancellationToken","onUnexpectedError","onUnexpectedExternalError","Disposable","DisposableStore","isDiffEditor","EditorAction","registerEditorAction","registerEditorContribution","registerModelAndPositionCommand","ICodeEditorService","Range","EditorContextKeys","DocumentHighlightKind","shouldSynchronizeModel","ILanguageFeaturesService","getHighlightDecorationOptions","IContextKeyService","RawContextKey","Schemas","ResourceMap","score","ctxHasWordHighlights","getOccurrencesAtPosition","registry","model","position","token","orderedByScore","ordered","map","provider","Promise","resolve","provideDocumentHighlights","then","undefined","isNonEmptyArray","result","set","uri","getOccurrencesAcrossMultipleModels","wordSeparators","otherModels","filteredModels","filter","otherModel","selector","getLanguageId","provideMultiDocumentHighlights","t","size","OccurenceAtPositionRequest","_model","_selection","_wordSeparators","_classCallCheck","_wordRange","_getCurrentWordRange","_result","_createClass","get","_this","_compute","value","selection","word","getWordAtPosition","getPosition","startLineNumber","startColumn","endColumn","isValid","decorations","lineNumber","currentWordRange","requestIsValid","Boolean","equalsRange","len","range","getRange","cancel","SemanticOccurenceAtPositionRequest","_OccurenceAtPositionR","providers","_this2","_callSuper","_providers","_inherits","MultiModelOccurenceRequest","_OccurenceAtPositionR2","_this3","_otherModels","TextualOccurenceRequest","_OccurenceAtPositionR3","_this4","_selectionIsEmpty","isEmpty","_word","_this5","wordResult","allModels","concat","_toConsumableArray","_iterator","_createForOfIteratorHelper","_step","s","n","done","isDisposed","matches","findMatches","highlights","m","kind","Text","err","e","f","currentSelectionIsEmpty","_get","_getPrototypeOf","prototype","call","computeOccurencesAtPosition","has","computeOccurencesMultiModel","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","accessor","languageFeaturesService","wrap","_callee$","_context","prev","next","documentHighlightProvider","None","sent","abrupt","stop","_x","_x2","_x3","apply","WordHighlighter","editor","multiProviders","contextKeyService","codeEditorService","_this6","toUnhook","workerRequestTokenId","workerRequestCompleted","workerRequestValue","lastCursorPositionChangeTime","renderDecorationsTimer","multiDocumentProviders","_hasWordHighlights","bindTo","_ignorePositionChangeEvent","occurrencesHighlight","getOption","getModel","add","onDidChangeCursorPosition","_onPositionChanged","onDidFocusEditorText","workerRequest","_run","onDidChangeModelContent","_stopAll","onDidChangeModel","newModelUrl","oldModelUrl","_stopSingular","query","onDidChangeConfiguration","newValue","createDecorationsCollection","hasDecorations","restore","_getSortedHighlights","getRanges","sort","compareRangesUsingStarts","moveNext","_this7","index","findIndex","containsPosition","newIndex","dest","setPosition","getStartPosition","revealRangeInCenterIfOutsideViewport","_getWord","lineContent","getLineContent","moveBack","_this8","_removeSingleDecorations","hasModel","currentDecorationIDs","storedDecorations","removeDecorations","clear","_removeAllDecorations","currentEditors","listCodeEditors","deleteURI","_iterator2","_step2","push","editorHighlighterContrib","WordHighlighterContribution","wordHighlighter","_i","_deleteURI","_a","_b","_c","_d","hasTextFocus","scheme","vscodeNotebookCell","modelInfo","clearTimeout","reason","editorSelection","getSelection","column","getOtherModelsToHighlight","isNotebookEditor","currentModels","_iterator3","_step3","tempModel","_iterator4","_step4","diffModel","modified","_iterator5","_step5","isValidModel","_this9","workerRequestIsValid","endLineNumber","Date","getTime","_beginRenderDecorations","myRequestId","otherModelsToHighlight","computeWithModel","data","_this10","currentTime","minimumRenderTime","renderDecorations","setTimeout","_this11","_iterator6","_step6","_loop","newDecorations","oldDecorationIDs","newDocumentHighlights","_iterator7","_step7","highlight","options","newDecorationIDs","changeDecorations","changeAccessor","deltaDecorations","dispose","_Disposable","_this12","_wordHighlighter","createWordHighlighterIfPossible","isTooLargeForTokenization","multiDocumentHighlightProvider","_register","saveViewState","restoreViewState","state","getContribution","ID","WordHighlightNavigationAction","_EditorAction","opts","_this13","_isNext","run","controller","NextWordHighlightAction","_WordHighlightNavigat","id","label","localize","alias","precondition","kbOpts","kbExpr","editorTextFocus","primary","weight","PrevWordHighlightAction","_WordHighlightNavigat2","TriggerWordHighlightAction","_EditorAction2","toNegated","args"],"sources":["/Users/yinger/Desktop/z95_exam_frontend/node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/wordHighlighter.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar WordHighlighter_1, WordHighlighterContribution_1;\nimport * as nls from '../../../../nls.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, first, timeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport { shouldSynchronizeModel } from '../../../common/model.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getHighlightDecorationOptions } from './highlightDecorations.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { score } from '../../../common/languageSelector.js';\n// import { TextualMultiDocumentHighlightFeature } from 'vs/editor/contrib/wordHighlighter/browser/textualHighlightProvider';\n// import { registerEditorFeature } from 'vs/editor/common/editorFeatures';\nconst ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\nexport function getOccurrencesAtPosition(registry, model, position, token) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = none empty array)\n    return first(orderedByScore.map(provider => () => {\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), arrays.isNonEmptyArray).then(result => {\n        if (result) {\n            const map = new ResourceMap();\n            map.set(model.uri, result);\n            return map;\n        }\n        return new ResourceMap();\n    });\n}\nexport function getOccurrencesAcrossMultipleModels(registry, model, position, wordSeparators, token, otherModels) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = none empty array)\n    return first(orderedByScore.map(provider => () => {\n        const filteredModels = otherModels.filter(otherModel => {\n            return shouldSynchronizeModel(otherModel);\n        }).filter(otherModel => {\n            return score(provider.selector, otherModel.uri, otherModel.getLanguageId(), true, undefined, undefined) > 0;\n        });\n        return Promise.resolve(provider.provideMultiDocumentHighlights(model, position, filteredModels, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), (t) => t instanceof ResourceMap && t.size > 0);\n}\nclass OccurenceAtPositionRequest {\n    constructor(_model, _selection, _wordSeparators) {\n        this._model = _model;\n        this._selection = _selection;\n        this._wordSeparators = _wordSeparators;\n        this._wordRange = this._getCurrentWordRange(_model, _selection);\n        this._result = null;\n    }\n    get result() {\n        if (!this._result) {\n            this._result = createCancelablePromise(token => this._compute(this._model, this._selection, this._wordSeparators, token));\n        }\n        return this._result;\n    }\n    _getCurrentWordRange(model, selection) {\n        const word = model.getWordAtPosition(selection.getPosition());\n        if (word) {\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n        }\n        return null;\n    }\n    isValid(model, selection, decorations) {\n        const lineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endColumn = selection.endColumn;\n        const currentWordRange = this._getCurrentWordRange(model, selection);\n        let requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\n        // (Same symbol)\n        for (let i = 0, len = decorations.length; !requestIsValid && i < len; i++) {\n            const range = decorations.getRange(i);\n            if (range && range.startLineNumber === lineNumber) {\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\n                    requestIsValid = true;\n                }\n            }\n        }\n        return requestIsValid;\n    }\n    cancel() {\n        this.result.cancel();\n    }\n}\nclass SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAtPosition(this._providers, model, selection.getPosition(), token).then(value => {\n            if (!value) {\n                return new ResourceMap();\n            }\n            return value;\n        });\n    }\n}\nclass MultiModelOccurenceRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers, otherModels) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n        this._otherModels = otherModels;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAcrossMultipleModels(this._providers, model, selection.getPosition(), wordSeparators, token, this._otherModels).then(value => {\n            if (!value) {\n                return new ResourceMap();\n            }\n            return value;\n        });\n    }\n}\nclass TextualOccurenceRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, word, wordSeparators, otherModels) {\n        super(model, selection, wordSeparators);\n        this._otherModels = otherModels;\n        this._selectionIsEmpty = selection.isEmpty();\n        this._word = word;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return timeout(250, token).then(() => {\n            const result = new ResourceMap();\n            let wordResult;\n            if (this._word) {\n                wordResult = this._word;\n            }\n            else {\n                wordResult = model.getWordAtPosition(selection.getPosition());\n            }\n            if (!wordResult) {\n                return new ResourceMap();\n            }\n            const allModels = [model, ...this._otherModels];\n            for (const otherModel of allModels) {\n                if (otherModel.isDisposed()) {\n                    continue;\n                }\n                const matches = otherModel.findMatches(wordResult.word, true, false, true, wordSeparators, false);\n                const highlights = matches.map(m => ({\n                    range: m.range,\n                    kind: DocumentHighlightKind.Text\n                }));\n                if (highlights) {\n                    result.set(otherModel.uri, highlights);\n                }\n            }\n            return result;\n        });\n    }\n    isValid(model, selection, decorations) {\n        const currentSelectionIsEmpty = selection.isEmpty();\n        if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\n            return false;\n        }\n        return super.isValid(model, selection, decorations);\n    }\n}\nfunction computeOccurencesAtPosition(registry, model, selection, word, wordSeparators) {\n    if (registry.has(model)) {\n        return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators, registry);\n    }\n    return new TextualOccurenceRequest(model, selection, word, wordSeparators, []);\n}\nfunction computeOccurencesMultiModel(registry, model, selection, word, wordSeparators, otherModels) {\n    if (registry.has(model)) {\n        return new MultiModelOccurenceRequest(model, selection, wordSeparators, registry, otherModels);\n    }\n    return new TextualOccurenceRequest(model, selection, word, wordSeparators, otherModels);\n}\nregisterModelAndPositionCommand('_executeDocumentHighlights', async (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const map = await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, position, CancellationToken.None);\n    return map === null || map === void 0 ? void 0 : map.get(model.uri);\n});\nlet WordHighlighter = WordHighlighter_1 = class WordHighlighter {\n    constructor(editor, providers, multiProviders, contextKeyService, codeEditorService) {\n        this.toUnhook = new DisposableStore();\n        this.workerRequestTokenId = 0;\n        this.workerRequestCompleted = false;\n        this.workerRequestValue = new ResourceMap();\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        this.editor = editor;\n        this.providers = providers;\n        this.multiDocumentProviders = multiProviders;\n        this.codeEditorService = codeEditorService;\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\n        this._ignorePositionChangeEvent = false;\n        this.occurrencesHighlight = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n        this.model = this.editor.getModel();\n        this.toUnhook.add(editor.onDidChangeCursorPosition((e) => {\n            if (this._ignorePositionChangeEvent) {\n                // We are changing the position => ignore this event\n                return;\n            }\n            if (this.occurrencesHighlight === 'off') {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this._onPositionChanged(e);\n        }));\n        this.toUnhook.add(editor.onDidFocusEditorText((e) => {\n            if (this.occurrencesHighlight === 'off') {\n                // Early exit if nothing needs to be done\n                return;\n            }\n            if (!this.workerRequest) {\n                this._run();\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeModelContent((e) => {\n            this._stopAll();\n        }));\n        this.toUnhook.add(editor.onDidChangeModel((e) => {\n            if (!e.newModelUrl && e.oldModelUrl) {\n                this._stopSingular();\n            }\n            else {\n                if (WordHighlighter_1.query) {\n                    this._run();\n                }\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeConfiguration((e) => {\n            const newValue = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n            if (this.occurrencesHighlight !== newValue) {\n                this.occurrencesHighlight = newValue;\n                this._stopAll();\n            }\n        }));\n        this.decorations = this.editor.createDecorationsCollection();\n        this.workerRequestTokenId = 0;\n        this.workerRequest = null;\n        this.workerRequestCompleted = false;\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        // if there is a query already, highlight off that query\n        if (WordHighlighter_1.query) {\n            this._run();\n        }\n    }\n    hasDecorations() {\n        return (this.decorations.length > 0);\n    }\n    restore() {\n        if (this.occurrencesHighlight === 'off') {\n            return;\n        }\n        this._run();\n    }\n    _getSortedHighlights() {\n        return (this.decorations.getRanges()\n            .sort(Range.compareRangesUsingStarts));\n    }\n    moveNext() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index + 1) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    moveBack() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index - 1 + highlights.length) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    _removeSingleDecorations() {\n        // return if no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const currentDecorationIDs = WordHighlighter_1.storedDecorations.get(this.editor.getModel().uri);\n        if (!currentDecorationIDs) {\n            return;\n        }\n        this.editor.removeDecorations(currentDecorationIDs);\n        WordHighlighter_1.storedDecorations.delete(this.editor.getModel().uri);\n        if (this.decorations.length > 0) {\n            this.decorations.clear();\n            this._hasWordHighlights.set(false);\n        }\n    }\n    _removeAllDecorations() {\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        const deleteURI = [];\n        // iterate over editors and store models in currentModels\n        for (const editor of currentEditors) {\n            if (!editor.hasModel()) {\n                continue;\n            }\n            const currentDecorationIDs = WordHighlighter_1.storedDecorations.get(editor.getModel().uri);\n            if (!currentDecorationIDs) {\n                continue;\n            }\n            editor.removeDecorations(currentDecorationIDs);\n            deleteURI.push(editor.getModel().uri);\n            const editorHighlighterContrib = WordHighlighterContribution.get(editor);\n            if (!(editorHighlighterContrib === null || editorHighlighterContrib === void 0 ? void 0 : editorHighlighterContrib.wordHighlighter)) {\n                continue;\n            }\n            if (editorHighlighterContrib.wordHighlighter.decorations.length > 0) {\n                editorHighlighterContrib.wordHighlighter.decorations.clear();\n                editorHighlighterContrib.wordHighlighter.workerRequest = null;\n                editorHighlighterContrib.wordHighlighter._hasWordHighlights.set(false);\n            }\n        }\n        for (const uri of deleteURI) {\n            WordHighlighter_1.storedDecorations.delete(uri);\n        }\n    }\n    _stopSingular() {\n        var _a, _b, _c, _d;\n        // Remove any existing decorations + a possible query, and re - run to update decorations\n        this._removeSingleDecorations();\n        if (this.editor.hasTextFocus()) {\n            if (((_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri.scheme) !== Schemas.vscodeNotebookCell && ((_c = (_b = WordHighlighter_1.query) === null || _b === void 0 ? void 0 : _b.modelInfo) === null || _c === void 0 ? void 0 : _c.model.uri.scheme) !== Schemas.vscodeNotebookCell) { // clear query if focused non-nb editor\n                WordHighlighter_1.query = null;\n                this._run(); // TODO: @Yoyokrazy -- investigate why we need a full rerun here. likely addressed a case/patch in the first iteration of this feature\n            }\n            else { // remove modelInfo to account for nb cell being disposed\n                if ((_d = WordHighlighter_1.query) === null || _d === void 0 ? void 0 : _d.modelInfo) {\n                    WordHighlighter_1.query.modelInfo = null;\n                }\n            }\n        }\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _stopAll() {\n        // Remove any existing decorations\n        // TODO: @Yoyokrazy -- this triggers as notebooks scroll, causing highlights to disappear momentarily.\n        // maybe a nb type check?\n        this._removeAllDecorations();\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _onPositionChanged(e) {\n        var _a;\n        // disabled\n        if (this.occurrencesHighlight === 'off') {\n            this._stopAll();\n            return;\n        }\n        // ignore typing & other\n        // need to check if the model is a notebook cell, should not stop if nb\n        if (e.reason !== 3 /* CursorChangeReason.Explicit */ && ((_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri.scheme) !== Schemas.vscodeNotebookCell) {\n            this._stopAll();\n            return;\n        }\n        this._run();\n    }\n    _getWord() {\n        const editorSelection = this.editor.getSelection();\n        const lineNumber = editorSelection.startLineNumber;\n        const startColumn = editorSelection.startColumn;\n        if (this.model.isDisposed()) {\n            return null;\n        }\n        return this.model.getWordAtPosition({\n            lineNumber: lineNumber,\n            column: startColumn\n        });\n    }\n    getOtherModelsToHighlight(model) {\n        if (!model) {\n            return [];\n        }\n        // notebook case\n        const isNotebookEditor = model.uri.scheme === Schemas.vscodeNotebookCell;\n        if (isNotebookEditor) {\n            const currentModels = [];\n            const currentEditors = this.codeEditorService.listCodeEditors();\n            for (const editor of currentEditors) {\n                const tempModel = editor.getModel();\n                if (tempModel && tempModel !== model && tempModel.uri.scheme === Schemas.vscodeNotebookCell) {\n                    currentModels.push(tempModel);\n                }\n            }\n            return currentModels;\n        }\n        // inline case\n        // ? current works when highlighting outside of an inline diff, highlighting in.\n        // ? broken when highlighting within a diff editor. highlighting the main editor does not work\n        // ? editor group service could be useful here\n        const currentModels = [];\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        for (const editor of currentEditors) {\n            if (!isDiffEditor(editor)) {\n                continue;\n            }\n            const diffModel = editor.getModel();\n            if (!diffModel) {\n                continue;\n            }\n            if (model === diffModel.modified) { // embedded inline chat diff would pass this, allowing highlights\n                //? currentModels.push(diffModel.original);\n                currentModels.push(diffModel.modified);\n            }\n        }\n        if (currentModels.length) { // no matching editors have been found\n            return currentModels;\n        }\n        // multi-doc OFF\n        if (this.occurrencesHighlight === 'singleFile') {\n            return [];\n        }\n        // multi-doc ON\n        for (const editor of currentEditors) {\n            const tempModel = editor.getModel();\n            const isValidModel = tempModel && tempModel !== model;\n            if (isValidModel) {\n                currentModels.push(tempModel);\n            }\n        }\n        return currentModels;\n    }\n    _run() {\n        var _a;\n        let workerRequestIsValid;\n        const hasTextFocus = this.editor.hasTextFocus();\n        if (!hasTextFocus) { // new nb cell scrolled in, didChangeModel fires\n            if (!WordHighlighter_1.query) { // no previous query, nothing to highlight off of\n                return;\n            }\n        }\n        else { // has text focus\n            const editorSelection = this.editor.getSelection();\n            // ignore multiline selection\n            if (!editorSelection || editorSelection.startLineNumber !== editorSelection.endLineNumber) {\n                WordHighlighter_1.query = null;\n                this._stopAll();\n                return;\n            }\n            const startColumn = editorSelection.startColumn;\n            const endColumn = editorSelection.endColumn;\n            const word = this._getWord();\n            // The selection must be inside a word or surround one word at most\n            if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\n                // no previous query, nothing to highlight\n                WordHighlighter_1.query = null;\n                this._stopAll();\n                return;\n            }\n            // All the effort below is trying to achieve this:\n            // - when cursor is moved to a word, trigger immediately a findOccurrences request\n            // - 250ms later after the last cursor move event, render the occurrences\n            // - no flickering!\n            workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this.decorations));\n            WordHighlighter_1.query = {\n                modelInfo: {\n                    model: this.model,\n                    selection: editorSelection,\n                },\n                word: word\n            };\n        }\n        // There are 4 cases:\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\n        // c) old workerRequest is valid, but not completed\n        // d) old workerRequest is not valid\n        // For a) no action is needed\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\n        if (workerRequestIsValid) {\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\n                // case b)\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\n                clearTimeout(this.renderDecorationsTimer);\n                this.renderDecorationsTimer = -1;\n                this._beginRenderDecorations();\n            }\n        }\n        else {\n            // case d)\n            // Stop all previous actions and start fresh\n            this._stopAll();\n            const myRequestId = ++this.workerRequestTokenId;\n            this.workerRequestCompleted = false;\n            const otherModelsToHighlight = this.getOtherModelsToHighlight(this.editor.getModel());\n            // when reaching here, there are two possible states.\n            // \t\t1) we have text focus, and a valid query was updated.\n            // \t\t2) we do not have text focus, and a valid query is cached.\n            // the query will ALWAYS have the correct data for the current highlight request, so it can always be passed to the workerRequest safely\n            if (!WordHighlighter_1.query.modelInfo || WordHighlighter_1.query.modelInfo.model.isDisposed()) {\n                return;\n            }\n            this.workerRequest = this.computeWithModel(WordHighlighter_1.query.modelInfo.model, WordHighlighter_1.query.modelInfo.selection, WordHighlighter_1.query.word, otherModelsToHighlight);\n            (_a = this.workerRequest) === null || _a === void 0 ? void 0 : _a.result.then(data => {\n                if (myRequestId === this.workerRequestTokenId) {\n                    this.workerRequestCompleted = true;\n                    this.workerRequestValue = data || [];\n                    this._beginRenderDecorations();\n                }\n            }, onUnexpectedError);\n        }\n    }\n    computeWithModel(model, selection, word, otherModels) {\n        if (!otherModels.length) {\n            return computeOccurencesAtPosition(this.providers, model, selection, word, this.editor.getOption(131 /* EditorOption.wordSeparators */));\n        }\n        else {\n            return computeOccurencesMultiModel(this.multiDocumentProviders, model, selection, word, this.editor.getOption(131 /* EditorOption.wordSeparators */), otherModels);\n        }\n    }\n    _beginRenderDecorations() {\n        const currentTime = (new Date()).getTime();\n        const minimumRenderTime = this.lastCursorPositionChangeTime + 250;\n        if (currentTime >= minimumRenderTime) {\n            // Synchronous\n            this.renderDecorationsTimer = -1;\n            this.renderDecorations();\n        }\n        else {\n            // Asynchronous\n            this.renderDecorationsTimer = setTimeout(() => {\n                this.renderDecorations();\n            }, (minimumRenderTime - currentTime));\n        }\n    }\n    renderDecorations() {\n        var _a, _b, _c;\n        this.renderDecorationsTimer = -1;\n        // create new loop, iterate over current editors using this.codeEditorService.listCodeEditors(),\n        // if the URI of that codeEditor is in the map, then add the decorations to the decorations array\n        // then set the decorations for the editor\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        for (const editor of currentEditors) {\n            const editorHighlighterContrib = WordHighlighterContribution.get(editor);\n            if (!editorHighlighterContrib) {\n                continue;\n            }\n            const newDecorations = [];\n            const uri = (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri;\n            if (uri && this.workerRequestValue.has(uri)) {\n                const oldDecorationIDs = WordHighlighter_1.storedDecorations.get(uri);\n                const newDocumentHighlights = this.workerRequestValue.get(uri);\n                if (newDocumentHighlights) {\n                    for (const highlight of newDocumentHighlights) {\n                        if (!highlight.range) {\n                            continue;\n                        }\n                        newDecorations.push({\n                            range: highlight.range,\n                            options: getHighlightDecorationOptions(highlight.kind)\n                        });\n                    }\n                }\n                let newDecorationIDs = [];\n                editor.changeDecorations((changeAccessor) => {\n                    newDecorationIDs = changeAccessor.deltaDecorations(oldDecorationIDs !== null && oldDecorationIDs !== void 0 ? oldDecorationIDs : [], newDecorations);\n                });\n                WordHighlighter_1.storedDecorations = WordHighlighter_1.storedDecorations.set(uri, newDecorationIDs);\n                if (newDecorations.length > 0) {\n                    (_b = editorHighlighterContrib.wordHighlighter) === null || _b === void 0 ? void 0 : _b.decorations.set(newDecorations);\n                    (_c = editorHighlighterContrib.wordHighlighter) === null || _c === void 0 ? void 0 : _c._hasWordHighlights.set(true);\n                }\n            }\n        }\n    }\n    dispose() {\n        this._stopSingular();\n        this.toUnhook.dispose();\n    }\n};\nWordHighlighter.storedDecorations = new ResourceMap();\nWordHighlighter.query = null;\nWordHighlighter = WordHighlighter_1 = __decorate([\n    __param(4, ICodeEditorService)\n], WordHighlighter);\nlet WordHighlighterContribution = WordHighlighterContribution_1 = class WordHighlighterContribution extends Disposable {\n    static get(editor) {\n        return editor.getContribution(WordHighlighterContribution_1.ID);\n    }\n    constructor(editor, contextKeyService, languageFeaturesService, codeEditorService) {\n        super();\n        this._wordHighlighter = null;\n        const createWordHighlighterIfPossible = () => {\n            if (editor.hasModel() && !editor.getModel().isTooLargeForTokenization()) {\n                this._wordHighlighter = new WordHighlighter(editor, languageFeaturesService.documentHighlightProvider, languageFeaturesService.multiDocumentHighlightProvider, contextKeyService, codeEditorService);\n            }\n        };\n        this._register(editor.onDidChangeModel((e) => {\n            if (this._wordHighlighter) {\n                this._wordHighlighter.dispose();\n                this._wordHighlighter = null;\n            }\n            createWordHighlighterIfPossible();\n        }));\n        createWordHighlighterIfPossible();\n    }\n    get wordHighlighter() {\n        return this._wordHighlighter;\n    }\n    saveViewState() {\n        if (this._wordHighlighter && this._wordHighlighter.hasDecorations()) {\n            return true;\n        }\n        return false;\n    }\n    moveNext() {\n        var _a;\n        (_a = this._wordHighlighter) === null || _a === void 0 ? void 0 : _a.moveNext();\n    }\n    moveBack() {\n        var _a;\n        (_a = this._wordHighlighter) === null || _a === void 0 ? void 0 : _a.moveBack();\n    }\n    restoreViewState(state) {\n        if (this._wordHighlighter && state) {\n            this._wordHighlighter.restore();\n        }\n    }\n    dispose() {\n        if (this._wordHighlighter) {\n            this._wordHighlighter.dispose();\n            this._wordHighlighter = null;\n        }\n        super.dispose();\n    }\n};\nWordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\nWordHighlighterContribution = WordHighlighterContribution_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ICodeEditorService)\n], WordHighlighterContribution);\nexport { WordHighlighterContribution };\nclass WordHighlightNavigationAction extends EditorAction {\n    constructor(next, opts) {\n        super(opts);\n        this._isNext = next;\n    }\n    run(accessor, editor) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        if (this._isNext) {\n            controller.moveNext();\n        }\n        else {\n            controller.moveBack();\n        }\n    }\n}\nclass NextWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.wordHighlight.next',\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\n            alias: 'Go to Next Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass PrevWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.wordHighlight.prev',\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\n            alias: 'Go to Previous Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass TriggerWordHighlightAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.wordHighlight.trigger',\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\n            alias: 'Trigger Symbol Highlight',\n            precondition: ctxHasWordHighlights.toNegated(),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.restoreViewState(true);\n    }\n}\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(NextWordHighlightAction);\nregisterEditorAction(PrevWordHighlightAction);\nregisterEditorAction(TriggerWordHighlightAction);\n// registerEditorFeature(TextualMultiDocumentHighlightFeature);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}