{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _slicedToArray from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _get from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _typeof from \"/Users/yinger/Desktop/z95_exam_frontend/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.number.max-safe-integer.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.reflect.to-string-tag.js\";\nimport \"core-js/modules/es.string.includes.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if ((typeof Reflect === \"undefined\" ? \"undefined\" : _typeof(Reflect)) === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar StickyScrollController_1;\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { toggleCollapseState } from '../../folding/browser/foldingModel.js';\nvar StickyScrollController = StickyScrollController_1 = /*#__PURE__*/function (_Disposable) {\n  function StickyScrollController(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n    var _this;\n    _classCallCheck(this, StickyScrollController);\n    _this = _callSuper(this, StickyScrollController);\n    _this._editor = _editor;\n    _this._contextMenuService = _contextMenuService;\n    _this._languageFeaturesService = _languageFeaturesService;\n    _this._instaService = _instaService;\n    _this._contextKeyService = _contextKeyService;\n    _this._sessionStore = new DisposableStore();\n    _this._foldingModel = null;\n    _this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n    _this._candidateDefinitionsLength = -1;\n    _this._focusedStickyElementIndex = -1;\n    _this._enabled = false;\n    _this._focused = false;\n    _this._positionRevealed = false;\n    _this._onMouseDown = false;\n    _this._endLineNumbers = [];\n    _this._showEndForLine = null;\n    _this._stickyScrollWidget = new StickyScrollWidget(_this._editor);\n    _this._stickyLineCandidateProvider = new StickyLineCandidateProvider(_this._editor, _languageFeaturesService, _languageConfigurationService);\n    _this._register(_this._stickyScrollWidget);\n    _this._register(_this._stickyLineCandidateProvider);\n    _this._widgetState = new StickyScrollWidgetState([], [], 0);\n    _this._onDidResize();\n    _this._readConfiguration();\n    var stickyScrollDomNode = _this._stickyScrollWidget.getDomNode();\n    _this._register(_this._editor.onDidChangeConfiguration(function (e) {\n      if (e.hasChanged(115 /* EditorOption.stickyScroll */) || e.hasChanged(73 /* EditorOption.minimap */) || e.hasChanged(67 /* EditorOption.lineHeight */) || e.hasChanged(110 /* EditorOption.showFoldingControls */)) {\n        _this._readConfiguration();\n      }\n    }));\n    _this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(event) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this._onContextMenu(dom.getWindow(stickyScrollDomNode), event);\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()));\n    _this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(_this._contextKeyService);\n    _this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(_this._contextKeyService);\n    var focusTracker = _this._register(dom.trackFocus(stickyScrollDomNode));\n    _this._register(focusTracker.onDidBlur(function (_) {\n      // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n      // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n      if (_this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n        _this._focusedStickyElementIndex = -1;\n        _this.focus();\n      }\n      // In all other casees, dispose the focus on the sticky scroll\n      else {\n        _this._disposeFocusStickyScrollStore();\n      }\n    }));\n    _this._register(focusTracker.onDidFocus(function (_) {\n      _this.focus();\n    }));\n    _this._registerMouseListeners();\n    // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n    _this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, function (e) {\n      _this._onMouseDown = true;\n    }));\n    return _this;\n  }\n  _inherits(StickyScrollController, _Disposable);\n  return _createClass(StickyScrollController, [{\n    key: \"_disposeFocusStickyScrollStore\",\n    value: function _disposeFocusStickyScrollStore() {\n      var _a;\n      this._stickyScrollFocusedContextKey.set(false);\n      (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n      this._focused = false;\n      this._positionRevealed = false;\n      this._onMouseDown = false;\n    }\n  }, {\n    key: \"focus\",\n    value: function focus() {\n      // If the mouse is down, do not focus on the sticky scroll\n      if (this._onMouseDown) {\n        this._onMouseDown = false;\n        this._editor.focus();\n        return;\n      }\n      var focusState = this._stickyScrollFocusedContextKey.get();\n      if (focusState === true) {\n        return;\n      }\n      this._focused = true;\n      this._focusDisposableStore = new DisposableStore();\n      this._stickyScrollFocusedContextKey.set(true);\n      this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n      this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n  }, {\n    key: \"focusNext\",\n    value: function focusNext() {\n      if (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n        this._focusNav(true);\n      }\n    }\n  }, {\n    key: \"focusPrevious\",\n    value: function focusPrevious() {\n      if (this._focusedStickyElementIndex > 0) {\n        this._focusNav(false);\n      }\n    }\n  }, {\n    key: \"selectEditor\",\n    value: function selectEditor() {\n      this._editor.focus();\n    }\n    // True is next, false is previous\n  }, {\n    key: \"_focusNav\",\n    value: function _focusNav(direction) {\n      this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n      this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n  }, {\n    key: \"goToFocused\",\n    value: function goToFocused() {\n      var lineNumbers = this._stickyScrollWidget.lineNumbers;\n      this._disposeFocusStickyScrollStore();\n      this._revealPosition({\n        lineNumber: lineNumbers[this._focusedStickyElementIndex],\n        column: 1\n      });\n    }\n  }, {\n    key: \"_revealPosition\",\n    value: function _revealPosition(position) {\n      var _this2 = this;\n      this._reveaInEditor(position, function () {\n        return _this2._editor.revealPosition(position);\n      });\n    }\n  }, {\n    key: \"_revealLineInCenterIfOutsideViewport\",\n    value: function _revealLineInCenterIfOutsideViewport(position) {\n      var _this3 = this;\n      this._reveaInEditor(position, function () {\n        return _this3._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, 0 /* ScrollType.Smooth */);\n      });\n    }\n  }, {\n    key: \"_reveaInEditor\",\n    value: function _reveaInEditor(position, revealFunction) {\n      if (this._focused) {\n        this._disposeFocusStickyScrollStore();\n      }\n      this._positionRevealed = true;\n      revealFunction();\n      this._editor.setSelection(Range.fromPositions(position));\n      this._editor.focus();\n    }\n  }, {\n    key: \"_registerMouseListeners\",\n    value: function _registerMouseListeners() {\n      var _this4 = this;\n      var sessionStore = this._register(new DisposableStore());\n      var gesture = this._register(new ClickLinkGesture(this._editor, {\n        extractLineNumberFromMouseEvent: function extractLineNumberFromMouseEvent(e) {\n          var position = _this4._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n          return position ? position.lineNumber : 0;\n        }\n      }));\n      var getMouseEventTarget = function getMouseEventTarget(mouseEvent) {\n        if (!_this4._editor.hasModel()) {\n          return null;\n        }\n        if (mouseEvent.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || mouseEvent.target.detail !== _this4._stickyScrollWidget.getId()) {\n          // not hovering over our widget\n          return null;\n        }\n        var mouseTargetElement = mouseEvent.target.element;\n        if (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n          // not on a span element rendering text\n          return null;\n        }\n        var position = _this4._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n        if (!position) {\n          // not hovering a sticky scroll line\n          return null;\n        }\n        return {\n          range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n          textElement: mouseTargetElement\n        };\n      };\n      var stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n      this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, function (mouseEvent) {\n        if (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n          // modifier pressed\n          return;\n        }\n        if (!mouseEvent.leftButton) {\n          // not left click\n          return;\n        }\n        if (mouseEvent.shiftKey) {\n          // shift click\n          var lineIndex = _this4._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n          if (lineIndex === null) {\n            return;\n          }\n          var _position = new Position(_this4._endLineNumbers[lineIndex], 1);\n          _this4._revealLineInCenterIfOutsideViewport(_position);\n          return;\n        }\n        var isInFoldingIconDomNode = _this4._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n        if (isInFoldingIconDomNode) {\n          // clicked on folding icon\n          var lineNumber = _this4._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n          _this4._toggleFoldingRegionForLine(lineNumber);\n          return;\n        }\n        var isInStickyLine = _this4._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n        if (!isInStickyLine) {\n          return;\n        }\n        // normal click\n        var position = _this4._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n        if (!position) {\n          var _lineNumber = _this4._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n          if (_lineNumber === null) {\n            // not hovering a sticky scroll line\n            return;\n          }\n          position = new Position(_lineNumber, 1);\n        }\n        _this4._revealPosition(position);\n      }));\n      this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_MOVE, function (mouseEvent) {\n        if (mouseEvent.shiftKey) {\n          var currentEndForLineIndex = _this4._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n          if (currentEndForLineIndex === null || _this4._showEndForLine !== null && _this4._showEndForLine === currentEndForLineIndex) {\n            return;\n          }\n          _this4._showEndForLine = currentEndForLineIndex;\n          _this4._renderStickyScroll();\n          return;\n        }\n        if (_this4._showEndForLine !== null) {\n          _this4._showEndForLine = null;\n          _this4._renderStickyScroll();\n        }\n      }));\n      this._register(dom.addDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_LEAVE, function (e) {\n        if (_this4._showEndForLine !== null) {\n          _this4._showEndForLine = null;\n          _this4._renderStickyScroll();\n        }\n      }));\n      this._register(gesture.onMouseMoveOrRelevantKeyDown(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n          mouseEvent = _ref3[0],\n          _keyboardEvent = _ref3[1];\n        var mouseTarget = getMouseEventTarget(mouseEvent);\n        if (!mouseTarget || !mouseEvent.hasTriggerModifier || !_this4._editor.hasModel()) {\n          sessionStore.clear();\n          return;\n        }\n        var range = mouseTarget.range,\n          textElement = mouseTarget.textElement;\n        if (!range.equalsRange(_this4._stickyRangeProjectedOnEditor)) {\n          _this4._stickyRangeProjectedOnEditor = range;\n          sessionStore.clear();\n        } else if (textElement.style.textDecoration === 'underline') {\n          return;\n        }\n        var cancellationToken = new CancellationTokenSource();\n        sessionStore.add(toDisposable(function () {\n          return cancellationToken.dispose(true);\n        }));\n        var currentHTMLChild;\n        getDefinitionsAtPosition(_this4._languageFeaturesService.definitionProvider, _this4._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), cancellationToken.token).then(function (candidateDefinitions) {\n          if (cancellationToken.token.isCancellationRequested) {\n            return;\n          }\n          if (candidateDefinitions.length !== 0) {\n            _this4._candidateDefinitionsLength = candidateDefinitions.length;\n            var childHTML = textElement;\n            if (currentHTMLChild !== childHTML) {\n              sessionStore.clear();\n              currentHTMLChild = childHTML;\n              currentHTMLChild.style.textDecoration = 'underline';\n              sessionStore.add(toDisposable(function () {\n                currentHTMLChild.style.textDecoration = 'none';\n              }));\n            } else if (!currentHTMLChild) {\n              currentHTMLChild = childHTML;\n              currentHTMLChild.style.textDecoration = 'underline';\n              sessionStore.add(toDisposable(function () {\n                currentHTMLChild.style.textDecoration = 'none';\n              }));\n            }\n          } else {\n            sessionStore.clear();\n          }\n        });\n      }));\n      this._register(gesture.onCancel(function () {\n        sessionStore.clear();\n      }));\n      this._register(gesture.onExecute( /*#__PURE__*/function () {\n        var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n          var position;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(e.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || e.target.detail !== _this4._stickyScrollWidget.getId())) {\n                  _context2.next = 2;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 2:\n                position = _this4._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n                if (position) {\n                  _context2.next = 5;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 5:\n                if (!(!_this4._editor.hasModel() || !_this4._stickyRangeProjectedOnEditor)) {\n                  _context2.next = 7;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 7:\n                if (_this4._candidateDefinitionsLength > 1) {\n                  if (_this4._focused) {\n                    _this4._disposeFocusStickyScrollStore();\n                  }\n                  _this4._revealPosition({\n                    lineNumber: position.lineNumber,\n                    column: 1\n                  });\n                }\n                _this4._instaService.invokeFunction(goToDefinitionWithLocation, e, _this4._editor, {\n                  uri: _this4._editor.getModel().uri,\n                  range: _this4._stickyRangeProjectedOnEditor\n                });\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2);\n        }));\n        return function (_x2) {\n          return _ref4.apply(this, arguments);\n        };\n      }()));\n    }\n  }, {\n    key: \"_onContextMenu\",\n    value: function _onContextMenu(targetWindow, e) {\n      var event = new StandardMouseEvent(targetWindow, e);\n      this._contextMenuService.showContextMenu({\n        menuId: MenuId.StickyScrollContext,\n        getAnchor: function getAnchor() {\n          return event;\n        }\n      });\n    }\n  }, {\n    key: \"_toggleFoldingRegionForLine\",\n    value: function _toggleFoldingRegionForLine(line) {\n      if (!this._foldingModel || line === null) {\n        return;\n      }\n      var stickyLine = this._stickyScrollWidget.getRenderedStickyLine(line);\n      var foldingIcon = stickyLine === null || stickyLine === void 0 ? void 0 : stickyLine.foldingIcon;\n      if (!foldingIcon) {\n        return;\n      }\n      toggleCollapseState(this._foldingModel, Number.MAX_VALUE, [line]);\n      foldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n      var scrollTop = (foldingIcon.isCollapsed ? this._editor.getTopForLineNumber(foldingIcon.foldingEndLine) : this._editor.getTopForLineNumber(foldingIcon.foldingStartLine)) - this._editor.getOption(67 /* EditorOption.lineHeight */) * stickyLine.index + 1;\n      this._editor.setScrollTop(scrollTop);\n      this._renderStickyScroll(line);\n    }\n  }, {\n    key: \"_readConfiguration\",\n    value: function _readConfiguration() {\n      var _this5 = this;\n      var options = this._editor.getOption(115 /* EditorOption.stickyScroll */);\n      if (options.enabled === false) {\n        this._editor.removeOverlayWidget(this._stickyScrollWidget);\n        this._sessionStore.clear();\n        this._enabled = false;\n        return;\n      } else if (options.enabled && !this._enabled) {\n        // When sticky scroll was just enabled, add the listeners on the sticky scroll\n        this._editor.addOverlayWidget(this._stickyScrollWidget);\n        this._sessionStore.add(this._editor.onDidScrollChange(function (e) {\n          if (e.scrollTopChanged) {\n            _this5._showEndForLine = null;\n            _this5._renderStickyScroll();\n          }\n        }));\n        this._sessionStore.add(this._editor.onDidLayoutChange(function () {\n          return _this5._onDidResize();\n        }));\n        this._sessionStore.add(this._editor.onDidChangeModelTokens(function (e) {\n          return _this5._onTokensChange(e);\n        }));\n        this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(function () {\n          _this5._showEndForLine = null;\n          _this5._renderStickyScroll();\n        }));\n        this._enabled = true;\n      }\n      var lineNumberOption = this._editor.getOption(68 /* EditorOption.lineNumbers */);\n      if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n        this._sessionStore.add(this._editor.onDidChangeCursorPosition(function () {\n          _this5._showEndForLine = null;\n          _this5._renderStickyScroll(0);\n        }));\n      }\n    }\n  }, {\n    key: \"_needsUpdate\",\n    value: function _needsUpdate(event) {\n      var stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n      var _iterator = _createForOfIteratorHelper(stickyLineNumbers),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var stickyLineNumber = _step.value;\n          var _iterator2 = _createForOfIteratorHelper(event.ranges),\n            _step2;\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var range = _step2.value;\n              if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                return true;\n              }\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return false;\n    }\n  }, {\n    key: \"_onTokensChange\",\n    value: function _onTokensChange(event) {\n      if (this._needsUpdate(event)) {\n        // Rebuilding the whole widget from line 0\n        this._renderStickyScroll(0);\n      }\n    }\n  }, {\n    key: \"_onDidResize\",\n    value: function _onDidResize() {\n      var layoutInfo = this._editor.getLayoutInfo();\n      // Make sure sticky scroll doesn't take up more than 25% of the editor\n      var theoreticalLines = layoutInfo.height / this._editor.getOption(67 /* EditorOption.lineHeight */);\n      this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n  }, {\n    key: \"_renderStickyScroll\",\n    value: function () {\n      var _renderStickyScroll2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(rebuildFromLine) {\n        var _a, _b, model, stickyLineVersion, focusedStickyElementLineNumber, previousFocusedLineNumberExists;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              model = this._editor.getModel();\n              if (!(!model || model.isTooLargeForTokenization())) {\n                _context3.next = 5;\n                break;\n              }\n              this._foldingModel = null;\n              this._stickyScrollWidget.setState(undefined, null);\n              return _context3.abrupt(\"return\");\n            case 5:\n              stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n              if (!(stickyLineVersion === undefined || stickyLineVersion === model.getVersionId())) {\n                _context3.next = 22;\n                break;\n              }\n              _context3.next = 9;\n              return (_a = FoldingController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.getFoldingModel();\n            case 9:\n              _context3.t1 = _b = _context3.sent;\n              _context3.t0 = _context3.t1 !== null;\n              if (!_context3.t0) {\n                _context3.next = 13;\n                break;\n              }\n              _context3.t0 = _b !== void 0;\n            case 13:\n              if (!_context3.t0) {\n                _context3.next = 17;\n                break;\n              }\n              _context3.t2 = _b;\n              _context3.next = 18;\n              break;\n            case 17:\n              _context3.t2 = null;\n            case 18:\n              this._foldingModel = _context3.t2;\n              this._widgetState = this.findScrollWidgetState();\n              this._stickyScrollVisibleContextKey.set(!(this._widgetState.startLineNumbers.length === 0));\n              if (!this._focused) {\n                this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n              } else {\n                // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                if (this._focusedStickyElementIndex === -1) {\n                  this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                  this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                  if (this._focusedStickyElementIndex !== -1) {\n                    this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                  }\n                } else {\n                  focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                  this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                  // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                  if (this._stickyScrollWidget.lineNumberCount === 0) {\n                    this._focusedStickyElementIndex = -1;\n                  } else {\n                    previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber); // If the line number is still there, do not change anything\n                    // If the line number is not there, set the new focused line to be the last line\n                    if (!previousFocusedLineNumberExists) {\n                      this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                    }\n                    this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                  }\n                }\n              }\n            case 22:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function _renderStickyScroll(_x3) {\n        return _renderStickyScroll2.apply(this, arguments);\n      }\n      return _renderStickyScroll;\n    }()\n  }, {\n    key: \"findScrollWidgetState\",\n    value: function findScrollWidgetState() {\n      var lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n      var maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(115 /* EditorOption.stickyScroll */).maxLineCount);\n      var scrollTop = this._editor.getScrollTop();\n      var lastLineRelativePosition = 0;\n      var startLineNumbers = [];\n      var endLineNumbers = [];\n      var arrayVisibleRanges = this._editor.getVisibleRanges();\n      if (arrayVisibleRanges.length !== 0) {\n        var fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n        var candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n        var _iterator3 = _createForOfIteratorHelper(candidateRanges),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var range = _step3.value;\n            var start = range.startLineNumber;\n            var end = range.endLineNumber;\n            var depth = range.nestingDepth;\n            if (end - start > 0) {\n              var topOfElementAtDepth = (depth - 1) * lineHeight;\n              var bottomOfElementAtDepth = depth * lineHeight;\n              var bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n              var topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n              var bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n              if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                startLineNumbers.push(start);\n                endLineNumbers.push(end + 1);\n                lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                break;\n              } else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                startLineNumbers.push(start);\n                endLineNumbers.push(end + 1);\n              }\n              if (startLineNumbers.length === maxNumberStickyLines) {\n                break;\n              }\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n      }\n      this._endLineNumbers = endLineNumbers;\n      return new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(StickyScrollController.prototype), \"dispose\", this).call(this);\n      this._sessionStore.dispose();\n    }\n  }], [{\n    key: \"get\",\n    value: function get(editor) {\n      return editor.getContribution(StickyScrollController_1.ID);\n    }\n  }]);\n}(Disposable);\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = StickyScrollController_1 = __decorate([__param(1, IContextMenuService), __param(2, ILanguageFeaturesService), __param(3, IInstantiationService), __param(4, ILanguageConfigurationService), __param(5, ILanguageFeatureDebounceService), __param(6, IContextKeyService)], StickyScrollController);\nexport { StickyScrollController };","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","_typeof","decorate","i","defineProperty","__param","paramIndex","decorator","StickyScrollController_1","Disposable","DisposableStore","toDisposable","ILanguageFeaturesService","StickyScrollWidget","StickyScrollWidgetState","StickyLineCandidateProvider","IInstantiationService","IContextMenuService","MenuId","IContextKeyService","EditorContextKeys","ClickLinkGesture","Range","getDefinitionsAtPosition","goToDefinitionWithLocation","Position","CancellationTokenSource","ILanguageConfigurationService","ILanguageFeatureDebounceService","dom","StickyRange","StandardMouseEvent","FoldingController","toggleCollapseState","StickyScrollController","_Disposable","_editor","_contextMenuService","_languageFeaturesService","_instaService","_languageConfigurationService","_languageFeatureDebounceService","_contextKeyService","_this","_classCallCheck","_callSuper","_sessionStore","_foldingModel","_maxStickyLines","Number","MAX_SAFE_INTEGER","_candidateDefinitionsLength","_focusedStickyElementIndex","_enabled","_focused","_positionRevealed","_onMouseDown","_endLineNumbers","_showEndForLine","_stickyScrollWidget","_stickyLineCandidateProvider","_register","_widgetState","_onDidResize","_readConfiguration","stickyScrollDomNode","getDomNode","onDidChangeConfiguration","e","hasChanged","addDisposableListener","EventType","CONTEXT_MENU","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","wrap","_callee$","_context","prev","next","_onContextMenu","getWindow","stop","_x","apply","_stickyScrollFocusedContextKey","stickyScrollFocused","bindTo","_stickyScrollVisibleContextKey","stickyScrollVisible","focusTracker","trackFocus","onDidBlur","_","clientHeight","focus","_disposeFocusStickyScrollStore","onDidFocus","_registerMouseListeners","MOUSE_DOWN","_inherits","_createClass","value","_a","set","_focusDisposableStore","dispose","focusState","get","lineNumbers","focusLineWithIndex","focusNext","lineNumberCount","_focusNav","focusPrevious","selectEditor","direction","goToFocused","_revealPosition","lineNumber","column","position","_this2","_reveaInEditor","revealPosition","_revealLineInCenterIfOutsideViewport","_this3","revealLineInCenterIfOutsideViewport","revealFunction","setSelection","fromPositions","_this4","sessionStore","gesture","extractLineNumberFromMouseEvent","getEditorPositionFromNode","element","getMouseEventTarget","mouseEvent","hasModel","type","detail","getId","mouseTargetElement","innerText","innerHTML","range","textElement","stickyScrollWidgetDomNode","addStandardDisposableListener","CLICK","ctrlKey","altKey","metaKey","leftButton","shiftKey","lineIndex","getLineIndexFromChildDomNode","isInFoldingIconDomNode","getLineNumberFromChildDomNode","_toggleFoldingRegionForLine","isInStickyLine","MOUSE_MOVE","currentEndForLineIndex","_renderStickyScroll","MOUSE_LEAVE","onMouseMoveOrRelevantKeyDown","_ref2","_ref3","_slicedToArray","_keyboardEvent","mouseTarget","hasTriggerModifier","clear","equalsRange","_stickyRangeProjectedOnEditor","style","textDecoration","cancellationToken","add","currentHTMLChild","definitionProvider","getModel","startLineNumber","startColumn","token","then","candidateDefinitions","isCancellationRequested","childHTML","onCancel","onExecute","_ref4","_callee2","_callee2$","_context2","abrupt","invokeFunction","uri","_x2","targetWindow","showContextMenu","menuId","StickyScrollContext","getAnchor","line","stickyLine","getRenderedStickyLine","foldingIcon","MAX_VALUE","isCollapsed","scrollTop","getTopForLineNumber","foldingEndLine","foldingStartLine","getOption","index","setScrollTop","_this5","options","enabled","removeOverlayWidget","addOverlayWidget","onDidScrollChange","scrollTopChanged","onDidLayoutChange","onDidChangeModelTokens","_onTokensChange","onDidChangeStickyScroll","lineNumberOption","renderType","onDidChangeCursorPosition","_needsUpdate","stickyLineNumbers","getCurrentLines","_iterator","_createForOfIteratorHelper","_step","s","n","done","stickyLineNumber","_iterator2","ranges","_step2","fromLineNumber","toLineNumber","err","f","layoutInfo","getLayoutInfo","theoreticalLines","height","Math","round","_renderStickyScroll2","_callee3","rebuildFromLine","_b","model","stickyLineVersion","focusedStickyElementLineNumber","previousFocusedLineNumberExists","_callee3$","_context3","isTooLargeForTokenization","setState","undefined","getVersionId","getFoldingModel","t1","sent","t0","t2","findScrollWidgetState","startLineNumbers","includes","_x3","lineHeight","maxNumberStickyLines","min","maxLineCount","getScrollTop","lastLineRelativePosition","endLineNumbers","arrayVisibleRanges","getVisibleRanges","fullVisibleRange","endLineNumber","candidateRanges","getCandidateStickyLinesIntersecting","_iterator3","_step3","start","end","depth","nestingDepth","topOfElementAtDepth","bottomOfElementAtDepth","bottomOfBeginningLine","getBottomForLineNumber","topOfEndLine","bottomOfEndLine","push","_get","_getPrototypeOf","prototype","call","editor","getContribution","ID"],"sources":["/Users/yinger/Desktop/z95_exam_frontend/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar StickyScrollController_1;\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { toggleCollapseState } from '../../folding/browser/foldingModel.js';\nlet StickyScrollController = StickyScrollController_1 = class StickyScrollController extends Disposable {\n    constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instaService = _instaService;\n        this._contextKeyService = _contextKeyService;\n        this._sessionStore = new DisposableStore();\n        this._foldingModel = null;\n        this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n        this._candidateDefinitionsLength = -1;\n        this._focusedStickyElementIndex = -1;\n        this._enabled = false;\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n        this._endLineNumbers = [];\n        this._showEndForLine = null;\n        this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n        this._register(this._stickyScrollWidget);\n        this._register(this._stickyLineCandidateProvider);\n        this._widgetState = new StickyScrollWidgetState([], [], 0);\n        this._onDidResize();\n        this._readConfiguration();\n        const stickyScrollDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(115 /* EditorOption.stickyScroll */)\n                || e.hasChanged(73 /* EditorOption.minimap */)\n                || e.hasChanged(67 /* EditorOption.lineHeight */)\n                || e.hasChanged(110 /* EditorOption.showFoldingControls */)) {\n                this._readConfiguration();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, async (event) => {\n            this._onContextMenu(dom.getWindow(stickyScrollDomNode), event);\n        }));\n        this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n        this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n        const focusTracker = this._register(dom.trackFocus(stickyScrollDomNode));\n        this._register(focusTracker.onDidBlur(_ => {\n            // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n            // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n            if (this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n                this._focusedStickyElementIndex = -1;\n                this.focus();\n            }\n            // In all other casees, dispose the focus on the sticky scroll\n            else {\n                this._disposeFocusStickyScrollStore();\n            }\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        this._registerMouseListeners();\n        // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, (e) => {\n            this._onMouseDown = true;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(StickyScrollController_1.ID);\n    }\n    _disposeFocusStickyScrollStore() {\n        var _a;\n        this._stickyScrollFocusedContextKey.set(false);\n        (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n    }\n    focus() {\n        // If the mouse is down, do not focus on the sticky scroll\n        if (this._onMouseDown) {\n            this._onMouseDown = false;\n            this._editor.focus();\n            return;\n        }\n        const focusState = this._stickyScrollFocusedContextKey.get();\n        if (focusState === true) {\n            return;\n        }\n        this._focused = true;\n        this._focusDisposableStore = new DisposableStore();\n        this._stickyScrollFocusedContextKey.set(true);\n        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    focusNext() {\n        if (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n            this._focusNav(true);\n        }\n    }\n    focusPrevious() {\n        if (this._focusedStickyElementIndex > 0) {\n            this._focusNav(false);\n        }\n    }\n    selectEditor() {\n        this._editor.focus();\n    }\n    // True is next, false is previous\n    _focusNav(direction) {\n        this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    goToFocused() {\n        const lineNumbers = this._stickyScrollWidget.lineNumbers;\n        this._disposeFocusStickyScrollStore();\n        this._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n    }\n    _revealPosition(position) {\n        this._reveaInEditor(position, () => this._editor.revealPosition(position));\n    }\n    _revealLineInCenterIfOutsideViewport(position) {\n        this._reveaInEditor(position, () => this._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, 0 /* ScrollType.Smooth */));\n    }\n    _reveaInEditor(position, revealFunction) {\n        if (this._focused) {\n            this._disposeFocusStickyScrollStore();\n        }\n        this._positionRevealed = true;\n        revealFunction();\n        this._editor.setSelection(Range.fromPositions(position));\n        this._editor.focus();\n    }\n    _registerMouseListeners() {\n        const sessionStore = this._register(new DisposableStore());\n        const gesture = this._register(new ClickLinkGesture(this._editor, {\n            extractLineNumberFromMouseEvent: (e) => {\n                const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n                return position ? position.lineNumber : 0;\n            }\n        }));\n        const getMouseEventTarget = (mouseEvent) => {\n            if (!this._editor.hasModel()) {\n                return null;\n            }\n            if (mouseEvent.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || mouseEvent.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return null;\n            }\n            const mouseTargetElement = mouseEvent.target.element;\n            if (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n                // not on a span element rendering text\n                return null;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return null;\n            }\n            return {\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n                textElement: mouseTargetElement\n            };\n        };\n        const stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, (mouseEvent) => {\n            if (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n                // modifier pressed\n                return;\n            }\n            if (!mouseEvent.leftButton) {\n                // not left click\n                return;\n            }\n            if (mouseEvent.shiftKey) {\n                // shift click\n                const lineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (lineIndex === null) {\n                    return;\n                }\n                const position = new Position(this._endLineNumbers[lineIndex], 1);\n                this._revealLineInCenterIfOutsideViewport(position);\n                return;\n            }\n            const isInFoldingIconDomNode = this._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n            if (isInFoldingIconDomNode) {\n                // clicked on folding icon\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                this._toggleFoldingRegionForLine(lineNumber);\n                return;\n            }\n            const isInStickyLine = this._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n            if (!isInStickyLine) {\n                return;\n            }\n            // normal click\n            let position = this._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n            if (!position) {\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                if (lineNumber === null) {\n                    // not hovering a sticky scroll line\n                    return;\n                }\n                position = new Position(lineNumber, 1);\n            }\n            this._revealPosition(position);\n        }));\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_MOVE, (mouseEvent) => {\n            if (mouseEvent.shiftKey) {\n                const currentEndForLineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (currentEndForLineIndex === null || this._showEndForLine !== null && this._showEndForLine === currentEndForLineIndex) {\n                    return;\n                }\n                this._showEndForLine = currentEndForLineIndex;\n                this._renderStickyScroll();\n                return;\n            }\n            if (this._showEndForLine !== null) {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_LEAVE, (e) => {\n            if (this._showEndForLine !== null) {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n            const mouseTarget = getMouseEventTarget(mouseEvent);\n            if (!mouseTarget || !mouseEvent.hasTriggerModifier || !this._editor.hasModel()) {\n                sessionStore.clear();\n                return;\n            }\n            const { range, textElement } = mouseTarget;\n            if (!range.equalsRange(this._stickyRangeProjectedOnEditor)) {\n                this._stickyRangeProjectedOnEditor = range;\n                sessionStore.clear();\n            }\n            else if (textElement.style.textDecoration === 'underline') {\n                return;\n            }\n            const cancellationToken = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n            let currentHTMLChild;\n            getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), cancellationToken.token).then((candidateDefinitions => {\n                if (cancellationToken.token.isCancellationRequested) {\n                    return;\n                }\n                if (candidateDefinitions.length !== 0) {\n                    this._candidateDefinitionsLength = candidateDefinitions.length;\n                    const childHTML = textElement;\n                    if (currentHTMLChild !== childHTML) {\n                        sessionStore.clear();\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                    else if (!currentHTMLChild) {\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                }\n                else {\n                    sessionStore.clear();\n                }\n            }));\n        }));\n        this._register(gesture.onCancel(() => {\n            sessionStore.clear();\n        }));\n        this._register(gesture.onExecute(async (e) => {\n            if (e.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || e.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return;\n            }\n            if (!this._editor.hasModel() || !this._stickyRangeProjectedOnEditor) {\n                return;\n            }\n            if (this._candidateDefinitionsLength > 1) {\n                if (this._focused) {\n                    this._disposeFocusStickyScrollStore();\n                }\n                this._revealPosition({ lineNumber: position.lineNumber, column: 1 });\n            }\n            this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n        }));\n    }\n    _onContextMenu(targetWindow, e) {\n        const event = new StandardMouseEvent(targetWindow, e);\n        this._contextMenuService.showContextMenu({\n            menuId: MenuId.StickyScrollContext,\n            getAnchor: () => event,\n        });\n    }\n    _toggleFoldingRegionForLine(line) {\n        if (!this._foldingModel || line === null) {\n            return;\n        }\n        const stickyLine = this._stickyScrollWidget.getRenderedStickyLine(line);\n        const foldingIcon = stickyLine === null || stickyLine === void 0 ? void 0 : stickyLine.foldingIcon;\n        if (!foldingIcon) {\n            return;\n        }\n        toggleCollapseState(this._foldingModel, Number.MAX_VALUE, [line]);\n        foldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n        const scrollTop = (foldingIcon.isCollapsed ?\n            this._editor.getTopForLineNumber(foldingIcon.foldingEndLine)\n            : this._editor.getTopForLineNumber(foldingIcon.foldingStartLine))\n            - this._editor.getOption(67 /* EditorOption.lineHeight */) * stickyLine.index + 1;\n        this._editor.setScrollTop(scrollTop);\n        this._renderStickyScroll(line);\n    }\n    _readConfiguration() {\n        const options = this._editor.getOption(115 /* EditorOption.stickyScroll */);\n        if (options.enabled === false) {\n            this._editor.removeOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.clear();\n            this._enabled = false;\n            return;\n        }\n        else if (options.enabled && !this._enabled) {\n            // When sticky scroll was just enabled, add the listeners on the sticky scroll\n            this._editor.addOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidScrollChange((e) => {\n                if (e.scrollTopChanged) {\n                    this._showEndForLine = null;\n                    this._renderStickyScroll();\n                }\n            }));\n            this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }));\n            this._enabled = true;\n        }\n        const lineNumberOption = this._editor.getOption(68 /* EditorOption.lineNumbers */);\n        if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => {\n                this._showEndForLine = null;\n                this._renderStickyScroll(0);\n            }));\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            // Rebuilding the whole widget from line 0\n            this._renderStickyScroll(0);\n        }\n    }\n    _onDidResize() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        // Make sure sticky scroll doesn't take up more than 25% of the editor\n        const theoreticalLines = layoutInfo.height / this._editor.getOption(67 /* EditorOption.lineHeight */);\n        this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n    async _renderStickyScroll(rebuildFromLine) {\n        var _a, _b;\n        const model = this._editor.getModel();\n        if (!model || model.isTooLargeForTokenization()) {\n            this._foldingModel = null;\n            this._stickyScrollWidget.setState(undefined, null);\n            return;\n        }\n        const stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n        if (stickyLineVersion === undefined || stickyLineVersion === model.getVersionId()) {\n            this._foldingModel = (_b = await ((_a = FoldingController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.getFoldingModel())) !== null && _b !== void 0 ? _b : null;\n            this._widgetState = this.findScrollWidgetState();\n            this._stickyScrollVisibleContextKey.set(!(this._widgetState.startLineNumbers.length === 0));\n            if (!this._focused) {\n                this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n            }\n            else {\n                // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                if (this._focusedStickyElementIndex === -1) {\n                    this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                    this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                    if (this._focusedStickyElementIndex !== -1) {\n                        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                    }\n                }\n                else {\n                    const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                    this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                    // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                    if (this._stickyScrollWidget.lineNumberCount === 0) {\n                        this._focusedStickyElementIndex = -1;\n                    }\n                    else {\n                        const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n                        // If the line number is still there, do not change anything\n                        // If the line number is not there, set the new focused line to be the last line\n                        if (!previousFocusedLineNumberExists) {\n                            this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                        }\n                        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                    }\n                }\n            }\n        }\n    }\n    findScrollWidgetState() {\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(115 /* EditorOption.stickyScroll */).maxLineCount);\n        const scrollTop = this._editor.getScrollTop();\n        let lastLineRelativePosition = 0;\n        const startLineNumbers = [];\n        const endLineNumbers = [];\n        const arrayVisibleRanges = this._editor.getVisibleRanges();\n        if (arrayVisibleRanges.length !== 0) {\n            const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n            const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n            for (const range of candidateRanges) {\n                const start = range.startLineNumber;\n                const end = range.endLineNumber;\n                const depth = range.nestingDepth;\n                if (end - start > 0) {\n                    const topOfElementAtDepth = (depth - 1) * lineHeight;\n                    const bottomOfElementAtDepth = depth * lineHeight;\n                    const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                    const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                    const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                    if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                        lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                    }\n                    if (startLineNumbers.length === maxNumberStickyLines) {\n                        break;\n                    }\n                }\n            }\n        }\n        this._endLineNumbers = endLineNumbers;\n        return new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = StickyScrollController_1 = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageConfigurationService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IContextKeyService)\n], StickyScrollController);\nexport { StickyScrollController };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}